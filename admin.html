<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ‚úÖ PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Just Marizete">
    
    <!-- ‚úÖ Icona per iOS -->
    <link rel="apple-touch-icon" href="./sources/images/icons/icon-192x192.png">
    <title>Admin - Just Marizete</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="sources/css/admin.css">
</head>

<body>



    <!-- ===== ADMIN DASHBOARD ===== -->
    <div class="admin-dashboard" id="admin-dashboard">

        <!-- Header Admin -->
        <header class="admin-header">
            <div class="admin-header-left">
                <img src="./sources/images/Logo_Just.svg" alt="Logo" class="admin-logo">
                <h1>Dashboard Admin</h1>
            </div>
            <div class="admin-header-right">
                <span class="admin-user">
                    <i class="ri-admin-line"></i>
                    <span id="admin-username">Admin</span>
                </span>
                <button id="btn-back-to-site">
                    <i class="ri-arrow-left-line"></i>
                    Torna al Sito
                </button>
                <button id="btn-logout">
                    <i class="ri-logout-box-line"></i>
                    Logout
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="admin-main">

            <!-- Sidebar -->
            <aside class="admin-sidebar">
                <nav class="admin-nav">
                    <button class="admin-nav-btn active" data-section="products">
                        <i class="ri-shopping-bag-3-line"></i>
                        Prodotti
                    </button>
                    <button class="admin-nav-btn" data-section="add-product">
                        <i class="ri-add-circle-line"></i>
                        Aggiungi Prodotto
                    </button>
                    <button class="admin-nav-btn" data-section="stats" onclick="showStats()">
                        <i class="ri-bar-chart-box-line"></i>
                        Statistiche
                    </button>
                    <button class="admin-nav-btn" data-section="settings">
                        <i class="ri-settings-3-line"></i>
                        Impostazioni
                    </button>
                </nav>
            </aside>

            <!-- Sezione Statistiche -->
<div class="stats-container" id="stats-container" style="display: none;">
    <div class="stat-card">
        <div class="stat-icon">üì¶</div>
        <div class="stat-info">
            <span class="stat-number" id="stat-total">0</span>
            <span class="stat-label">Prodotti Totali</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">üåø</div>
        <div class="stat-info">
            <span class="stat-number" id="stat-benessere">0</span>
            <span class="stat-label">Benessere</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">üíÑ</div>
        <div class="stat-info">
            <span class="stat-number" id="stat-bellezza">0</span>
            <span class="stat-label">Bellezza</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">üè†</div>
        <div class="stat-info">
            <span class="stat-number" id="stat-casa">0</span>
            <span class="stat-label">Casa</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">üíä</div>
        <div class="stat-info">
            <span class="stat-number" id="stat-integratori">0</span>
            <span class="stat-label">Integratori</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">üí∞</div>
        <div class="stat-info">
            <span class="stat-number" id="stat-valore">‚Ç¨0</span>
            <span class="stat-label">Valore Totale</span>
        </div>
    </div>
</div>

            <!-- Content Area -->
            <div class="admin-content">

                <!-- Sezione: Lista Prodotti -->
                <section class="admin-section active" id="section-products">
                    <div class="section-header">
                        <h2><i class="ri-shopping-bag-3-line"></i> Gestione Prodotti</h2>
                        <div class="section-actions">
                            <input type="text" id="search-products" placeholder="Cerca prodotto...">
                            <select id="filter-category">
                                <option value="">Tutte le categorie</option>
                                <option value="benessere">Linea Benessere</option>
                                <option value="bellezza">Linea Bellezza</option>
                                <option value="casa">Linea Casa</option>
                                <option value="integratori">Integratori</option>
                            </select>
                        </div>
                    </div>

                    <div class="products-table-container">
                        <table class="products-table" id="products-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Immagine</th>
                                    <th>Nome</th>
                                    <th>Categoria</th>
                                    <th>Prezzo</th>
                                    <th>Azioni</th>
                                </tr>
                            </thead>
                            <tbody id="products-tbody">
                                <!-- Prodotti inseriti da JS -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Sezione: Aggiungi Prodotto -->
                <section class="admin-section" id="section-add-product">
                    <div class="section-header">
                        <h2><i class="ri-add-circle-line"></i> Aggiungi Nuovo Prodotto</h2>
                    </div>

                    <form class="product-form" id="product-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-name">Nome Prodotto *</label>
                                <input type="text" id="product-name" required>
                            </div>
                            <div class="form-group">
                                <label for="product-price">Prezzo (‚Ç¨) *</label>
                                <input type="number" id="product-price" step="0.01" min="0" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-line">Linea *</label>
                                <select id="product-line" required>
                                    <option value="">Seleziona linea</option>
                                    <option value="benessere">üåø Benessere</option>
                                    <option value="bellezza">‚ú® Bellezza</option>
                                    <option value="casa">üè† Casa</option>
                                    <option value="integratori">üíä Integratori</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="product-subcategory">Sottocategoria *</label>
                                <select id="product-subcategory" required>
                                    <option value="">Prima seleziona la linea</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="product-description">Descrizione *</label>
                            <textarea id="product-description" rows="3" required></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Immagine Prodotto</label>

                                <!-- Toggle tipo input -->
                                <div style="margin-bottom: 10px;">
                                    <label style="cursor: pointer;">
                                        <input type="radio" name="image-type" value="local" checked
                                            onchange="toggleImageInput()">
                                        üìÅ Percorso locale
                                    </label>
                                    <label style="margin-left: 15px; cursor: pointer;">
                                        <input type="radio" name="image-type" value="url" onchange="toggleImageInput()">
                                        üîó Link URL
                                    </label>
                                </div>

                                <!-- Input locale -->
                                <input type="text" id="product-image-local"
                                    placeholder="./sources/images/categoria/immagine.png"
                                    oninput="updateImagePreview()">

                                <!-- Input URL (nascosto) -->
                                <input type="url" id="product-image-url" placeholder="https://esempio.com/immagine.jpg"
                                    style="display: none;" oninput="updateImagePreview()">

                                <!-- Campo nascosto per il valore finale -->
                                <input type="hidden" id="product-image">

                                <!-- Anteprima -->
                                <div id="image-preview"
                                    style="margin-top: 10px; min-height: 80px; border: 1px dashed #ccc; border-radius: 8px; padding: 10px; text-align: center; background: #f9f9f9;">
                                    <span style="color: #999;">Anteprima immagine</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="product-rating">Rating (1-5)</label>
                                <input type="number" id="product-rating" min="1" max="5" step="0.5" value="4">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Badge</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="badges" value="bestseller">
                                    ‚≠ê Bestseller
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="badges" value="new">
                                    üÜï Nuovo
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="badges" value="hot">
                                    üî• Hot
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="badges" value="sale">
                                    üí∞ Saldi
                                </label>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="reset" class="btn-secondary">
                                <i class="ri-refresh-line"></i>
                                Resetta
                            </button>
                            <button type="submit" class="btn-primary">
                                <i class="ri-add-line"></i>
                                Aggiungi Prodotto
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Sezione: Statistiche -->
                <section class="admin-section" id="section-stats">
                    <div class="section-header">
                        <h2><i class="ri-bar-chart-box-line"></i> Statistiche</h2>
                    </div>

                    <div class="stats-grid" id="stats-grid">
                        <!-- Stats inserite da JS -->
                    </div>
                </section>

                <!-- Sezione: Impostazioni -->
                <section class="admin-section" id="section-settings">
                    <div class="section-header">
                        <h2><i class="ri-settings-3-line"></i> Impostazioni</h2>
                    </div>

                    <div class="settings-content">


                        <div class="settings-card">
                            <h3><i class="ri-download-2-line"></i> Esporta Prodotti</h3>
                            <p>Scarica tutti i prodotti in formato JSON</p>
                            <button class="btn-secondary" id="export-products">
                                <i class="ri-file-download-line"></i>
                                Esporta JSON
                            </button>
                        </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- Modal Modifica Prodotto -->
    <div class="modal-overlay" id="edit-modal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="ri-edit-line"></i> Modifica Prodotto</h3>
                <button class="modal-close" id="modal-close">
                    <i class="ri-close-line"></i>
                </button>
            </div>
            <form class="modal-body" id="edit-product-form">
                <!-- Form copiato da JS -->
            </form>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <!-- 1. Firebase SDK (PRIMA di tutto) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- 2. Configurazione Firebase -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCAt6TWblWG0uclk0723eioeBjCqfwHIp8",
            authDomain: "just-marizete.firebaseapp.com",
            projectId: "just-marizete",
            storageBucket: "just-marizete.firebasestorage.app",
            messagingSenderId: "30378126861",
            appId: "1:30378126861:web:892aca8d5a5a4327e46f44"
        };
        firebase.initializeApp(firebaseConfig);
    </script>

    <!-- Scripts -->
    <script src="sources/js/products-data.js"></script>
    <script src="sources/js/admin.js"></script>
</body>

</html>